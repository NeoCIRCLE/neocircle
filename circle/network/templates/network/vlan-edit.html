{% extends "network/base.html" %}
{% load render_table from django_tables2 %}
{% load i18n %}
{% load l10n %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block content %}
<div class="page-header">
    <a href="{% url "network.vlan_delete" vid=vlan_vid %}" class="btn btn-danger pull-right"><i class="icon-remove-sign"></i> {% trans "Delete this vlan" %}</a>
    <h2>{{ form.name.value }} <small>{% trans "details of vlan" %}</small></h2>
</div>

<div class="row">
  <div class="col-sm-6">
    {% crispy form %}
  </div>
  <div class="col-sm-6">
    <div class="page-header">
      <h3>{% trans "Host list" %}</h3>
    </div>
    {% render_table host_list %}
    <div class="page-header">
      <h3>{% trans "Manage access" %}</h3>
    </div>
    <form action="{% url "network.vlan-acl" vid=vlan_vid %}" method="post">{% csrf_token %}
      <table class="table table-striped table-with-form-fields" id="vlan-access-table">
        <thead>
          <tr>
            <th></th>
            <th>{% trans "Who" %}</th>
            <th>{% trans "What" %}</th>
            <th><i class="icon-remove"></i></th>
        </tr></thead>
        <tbody>
            {% for i in acl.users %}
            <tr>
              <td><i class="icon-user"></i></td><td>{{i.user}}</td>
              <td>
                <select class="form-control" name="perm-u-{{i.user.id}}">
                  {% for id, name in acl.levels %}
                  <option{%if id = i.level%} selected="selected"{%endif%} value="{{id}}">{{name}}</option>
                  {% endfor %}
                </select>
              </td>
              <td>
                <input type="checkbox" name="remove-u-{{i.user.id}}" title="{% trans "Remove" %}"/>
              </td>
            </tr>
            {% endfor %}
            {% for i in acl.groups %}
            <tr>
              <td><i class="icon-group"></i></td><td>{{i.group}}</td>
              <td>
                <select class="form-control" name="perm-g-{{i.group.id}}">
                  {% for id, name in acl.levels %}
                  <option{%if id = i.level%} selected="selected"{%endif%} value="{{id}}">{{name}}</option>
                  {% endfor %}
                </select>
              </td>
              <td>
                <input type="checkbox" name="remove-g-{{i.group.id}}" title="{% trans "Remove" %}"/>
              </td>
            </tr>
            {% endfor %}
            <tr><td><i class="icon-plus"></i></td>
                <td><input type="text" class="form-control" name="perm-new-name"
                    placeholder="{% trans "Name of group or user" %}"></td>
                <td><select class="form-control" name="perm-new">
                        {% for id, name in acl.levels %}
                        <option value="{{id}}">{{name}}</option>
                        {% endfor %}
                </select></td><td></td>
            </tr>
      </tbody>
      </table>
      <div class="form-actions">
        <button type="submit" class="btn btn-success">{% trans "Save" %}</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
