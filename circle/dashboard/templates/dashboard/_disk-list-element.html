{% load i18n %}
{% load sizefieldtags %}

<i class="fa fa-file"></i>
{{ d.name }} (#{{ d.id }}) - {{ d.size|filesize }}


<span class="operation-wrapper pull-right">
  <div>
  {% if perms.view_snapshot and d.list_snapshots %}
    <input type="button" class="btn btn-default btn-xs show-snapshot-btn"
     data-toggle="collapse" data-target="#snapshots-{{ d.pk }}"
     value="{% trans "Show snapshots" %}" />
  {% endif %}
  {% if d.is_resizable %}
    {% if op.resize_disk %}
      <a href="{{ op.resize_disk.get_url }}?disk={{d.pk}}"
        class="btn btn-xs btn-{{ op.resize_disk.effect }} operation disk-resize-btn
        {% if op.resize_disk.disabled %}disabled{% endif %}">
        <i class="fa fa-{{ op.resize_disk.icon }} fa-fw-12"></i> {% trans "Resize" %}
      </a>
    {% else %}
      <a href="{% url "request.views.request-resize" vm_pk=instance.pk disk_pk=d.pk %}" class="btn btn-xs btn-primary operation">
        <i class="fa fa-arrows-alt fa-fw-12"></i> {% trans "Request resize" %}
      </a>
    {% endif %}
  {% endif %}
  {% if op.create_snapshot and not d.is_read_only and d.is_ready %}
    <a href="{{ op.create_snapshot.get_url }}?disk={{d.pk}}"
      class="btn btn-xs btn-{{ op.create_snapshot.effect }} operation disk-create_snapshot-btn
      {% if op.create_snapshot.disabled %}disabled{% endif %}">
      <i class="fa fa-{{ op.create_snapshot.icon }} fa-fw-12"></i> {% trans "Snapshot" %}
    </a>
  {% endif %}
  {% if op.remove_disk %}
    <a href="{{ op.remove_disk.get_url }}?disk={{d.pk}}"
      class="btn btn-xs btn-{{ op.remove_disk.effect}} operation disk-remove-btn
      {% if op.remove_disk.disabled %}disabled{% endif %}">
      <i class="fa fa-{{ op.remove_disk.icon }} fa-fw-12"></i> {% trans "Remove" %}
    </a>
  {% endif %}
  </div>
</span>
<br />
{% if request.user.is_superuser %}
  <small>{% trans "File name" %}: {{ d.filename }}</small><br />
  <small>{% trans "Bus" %}: {{ d.device_bus }}</small><br />
{% endif %}
<div style="clear: both;"></div>
{% if perms.storage.view_snapshot and d.list_snapshots %}
<div id="snapshots-{{ d.pk }}" class="collapse out snapshot-list">
  <table class="table table-striped info-panel small snapshot-table">
    {% for snap in d.list_snapshots %}
      <tr>
        <td>{{ snap.id }}</td>
        <td>{{ snap.name }}</td>
        <td><span title="{{ snap.date }}">{{ snap.date_human }}</span></td>
        <td>
          <div class="pull-right">
            <a href="{{ op.revert_snapshot.get_url }}?disk={{d.pk}}&snap_name={{ snap.name }}&snap_id={{ snap.id }}"
              class="btn btn-xs btn-{{ op.revert_snapshot.effect }} operation disk-revert_snapshot-btn
              {% if op.revert_snapshot.disabled %}disabled{% endif %}"
              title="{% trans "Revert" %}">
              <i class="fa fa-{{ op.revert_snapshot.icon }} fa-fw-12"></i>
            </a>
            <a href="{{ op.remove_snapshot.get_url }}?disk={{d.pk}}&snap_name={{ snap.name }}&snap_id={{ snap.id }}"
              class="btn btn-xs btn-{{ op.remove_snapshot.effect }} operation disk-remove_snapshot-btn
              {% if op.remove_snapshot.disabled %}disabled{% endif %}"
              title="{% trans "Remove" %}">
              <i class="fa fa-{{ op.remove_snapshot.icon }} fa-fw-12"></i>
            </a>
          </div>
        </td>
      </tr>
    {% endfor %}
  </table>
</div>
{% endif %}
