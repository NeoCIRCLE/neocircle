{% extends "dashboard/base.html" %}
{% load i18n %}
{% load render_table from django_tables2 %}
{% block content %}

<div class="alert alert-info">
  Tip of the day: you can select multiple vm instances while holding down the <strong>CTRL</strong> button!
</div>

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="no-margin"><i class="icon-desktop"></i> Your virtual machines</h3>
      </div>
      <div class="panel-body">
        <table class="table table-bordered table-striped table-hover vm-list-table">
          <thead>
            <tr>
              <!--<td style="width: 10px;"><input type="checkbox" id="check_all"/></td> -->
              <td style="width: 10px;">Id</td>
              <td>Name</td>
              <td>State</td>
              <td>Suspend in</td>
              <td>Delete in</td>
              <td style="width: 130px;">Admin</td>
              <td style="width: 10px;">Details</td>
              <td style="width: 10px;">Actions</td>
            </tr>
          </thead>
          <tbody>
            {% for i in "xxxxxxxxxxxxxxxxxxxxx" %}
            {% with forloop.counter as c %}
                {% include "dashboard/vm-list/test-one.html" %}
              {% endwith %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="no-margin"><i class="icon-desktop"></i> Your virtual machines</h3>
      </div>
      <div class="panel-body">
        {% render_table table %}
      </div>
    </div>
  </div>
</div>


<style>
  .popover {
    max-width: 600px;
  }

  .vm-list-selected, .vm-list-selected td {
    background-color: #e8e8e8 !important;
  }

  .vm-list-selected:hover, .vm-list-selected:hover td {
    background-color: #d0d0d0 !important;
  }

  .vm-list-selected td:first-child {
    font-weight: bold;
  }

  .vm-list-table-thin {
    width: 10px;
  }

  .vm-list-table-admin {
    width: 130px;
  }
</style>
{% endblock %}

{% block extra_js %}
$(function() {
    var ctrlDown = false;
    var ctrlKey = 17;

    $(document).keydown(function(e) {
      if (e.keyCode == ctrlKey) ctrlDown = true;
    }).keyup(function(e) {
      if (e.keyCode == ctrlKey) ctrlDown = false;
    });

    $('.vm-list-table').find('tr').click(function() {
      if (ctrlDown) {
        setRowColor($(this));
      } else {
        $('.vm-list-selected').removeClass('vm-list-selected');
        $(this).addClass('vm-list-selected');
      }
    });

    $('.vm-list-details').popover({
      'placement': 'auto',
      'html': true,
      'trigger': 'hover'
    });

    $('.vm-list-connect').popover({
      'placement': 'left',
      'html': true,
      'trigger': 'click'
    });

    $('tbody a').click(function(e) {
      // parent tr doesn't get selected when clicked
      e.stopPropagation();
      // browser doesn't jump to top when clicked the buttons
      if(!$(this).hasClass('real-link')) {
        return false;
      }
    });
  });


  function setRowColor(row) {
    if(!row.hasClass('vm-list-selected')) {
      row.addClass('vm-list-selected');
    } else {
      row.removeClass('vm-list-selected');
    }

  }
{% endblock %}
